---
title: "Airレジ API接続ステータスレポート"
type: api-documentation
status: active
created: "2025-10-13"
updated: "2025-10-13"
tags:
  - "project/airregi-analytics"
  - "integration/api"
---

# Airレジ API接続ステータスレポート

**作成日時**: 2025年10月13日 18:56
**テスト実施**: `python test_api.py`

---

## 📋 テスト結果サマリー

### 接続テスト結果
- **成功**: 0/5 エンドポイント
- **失敗**: 5/5 エンドポイント
- **エラー種別**: DNS解決エラー (`Failed to resolve 'api.airregi.jp'`)

### テスト対象エンドポイント
1. ❌ `https://api.airregi.jp/v1/health`
2. ❌ `https://api.airregi.jp/v1/status`
3. ❌ `https://api.airregi.jp/v1/ping`
4. ❌ `https://api.airregi.jp/v1/transactions`
5. ❌ `https://api.airregi.jp/v1/sales/summary`

---

## 🔍 問題分析

### 根本原因
**DNS解決エラー**が発生しており、以下の可能性があります：

1. **APIエンドポイントURLが推定である**
   - 現在使用中のURL `https://api.airregi.jp/v1` は推定ベース
   - 実際のAirレジ APIのURLが異なる可能性が高い

2. **API仕様の非公開**
   - Airレジのデータ連携APIは2025年8月19日リリース予定
   - 詳細な技術仕様が一般公開されていない可能性

3. **認証情報の有効範囲**
   - 提供されたAPIキー・トークンが特定のシステム向けの可能性
   - 直接API呼び出しではなく、連携システム経由の利用を想定している可能性

---

## 🎯 次のアクションプラン

### 【優先度：高】実際のAPI仕様の確認

#### 1. Airレジ バックオフィスで確認
```
1. Airレジ バックオフィスにログイン
2. 「設定」→「データ連携API」メニューへ移動
3. 以下の情報を確認:
   - 実際のAPIエンドポイントURL
   - API仕様書・ドキュメントへのリンク
   - サンプルコード・リクエスト例
   - 利用可能なエンドポイント一覧
```

#### 2. Airレジサポートへ問い合わせ
```
問い合わせ先:
- FAQページ: https://faq.airregi.jp/hc/ja/
- サポートページ: https://airregi.jp/jp/features/support/

問い合わせ内容:
「データ連携APIの技術仕様について」
- APIエンドポイントのベースURL
- 認証方法の詳細
- リクエスト・レスポンス形式
- 開発者向けドキュメントの入手方法
```

#### 3. 連携システム経由の利用を検討
Airレジのデータ連携APIは以下のシステムとの連携を想定している可能性があります：
- れすだく
- まかせてネット
- FLARO
- ASPIT
- Skymart

これらのシステムを介してデータ取得する方式かもしれません。

---

## 🔧 暫定対応策

### API仕様が判明するまでの代替アプローチ

#### オプション1: サンプルデータでシステムテスト
実際のデータ構造を想定したサンプルデータでシステムの動作確認を行う。

```bash
# サンプルデータ作成スクリプトを作成予定
python create_sample_data.py
python main.py --use-sample-data
```

#### オプション2: CSVインポート機能の追加
Airレジから手動エクスポートしたCSVファイルを読み込む機能を追加。

```bash
# CSV読み込み機能を追加予定
python import_csv.py --file airregi_export.csv
```

#### オプション3: 連携システムのAPI調査
れすだく等の連携システムがAPIを提供している場合、そちらを経由してデータ取得。

---

## 📝 取得が必要な情報

### 必須情報
- [ ] 実際のAPIエンドポイントURL
- [ ] 認証ヘッダーの正確な形式
- [ ] 利用可能なエンドポイント一覧
- [ ] リクエストパラメータの仕様
- [ ] レスポンスデータの構造

### 推奨情報
- [ ] レート制限の詳細
- [ ] エラーコード一覧
- [ ] サンプルコード・リクエスト例
- [ ] データ取得可能期間の詳細
- [ ] ページネーションの仕様

---

## 🛠️ システム調整が必要なファイル

API仕様が判明次第、以下のファイルを調整する必要があります：

### 1. APIクライアント
**ファイル**: `src/api/client.py`

**調整箇所**:
```python
# 現在（推定）
self.base_url = 'https://api.airregi.jp/v1'

# 実際のURLに変更
self.base_url = '実際のベースURL'

# 認証ヘッダーの調整
def _get_auth_headers(self):
    return {
        # 実際の認証形式に合わせて調整
    }
```

### 2. エンドポイント定義
**ファイル**: `src/api/client.py`

**調整箇所**:
- `get_transactions()` メソッドのエンドポイントパス
- `get_sales_summary()` メソッドのエンドポイントパス
- `get_settlements()` メソッドのエンドポイントパス

### 3. データ構造の調整
**ファイル**: `src/analysis/analyzer.py`

**調整箇所**:
- レスポンスデータの構造に合わせたパース処理
- フィールド名の調整

---

## 💡 現在利用可能な機能

API接続ができない現状でも、以下の機能は実装済みです：

### ✅ 実装完了している機能
1. **プロジェクト構造** - 完全構築済み
2. **環境設定** - APIキー・トークン設定済み
3. **ログ管理** - 完全実装
4. **データ分析エンジン** - 実装済み（データがあれば動作可能）
5. **レポート生成** - JSON・Excel出力機能完備
6. **エラーハンドリング** - リトライ機能含む

### 🔄 API仕様確定後に稼働開始できる機能
1. データ取得（日次・週次・月次）
2. 売上分析（日次サマリー、商品別、支払方法別）
3. 自動レポート生成
4. 定期実行（cron設定）

---

## 📞 サポート連絡先

### Airレジ公式サポート
- **FAQページ**: https://faq.airregi.jp/hc/ja/
- **サポートページ**: https://airregi.jp/jp/features/support/
- **データ連携API設定**: Airレジ バックオフィス > 設定 > データ連携API

### 問い合わせ時の推奨事項
1. APIキー・トークンを手元に準備
2. 「データ連携APIの技術仕様」について問い合わせ
3. 以下の情報を依頼:
   - APIエンドポイントURL
   - 技術ドキュメント
   - サンプルコード

---

## 📊 ログファイル

テスト実行時のログは以下に保存されています：
```
logs/APITest_20251013.log
logs/AirRegiAPI_20251013.log
```

詳細なエラー情報はログファイルを参照してください。

---

## 🎬 次のステップ

### すぐにできること
1. **Airレジ バックオフィスにログイン** してAPI情報を確認
2. **サポートに問い合わせ** て技術仕様を入手
3. **このレポートを参照** しながら必要情報を収集

### API仕様入手後
1. `src/api/client.py` のエンドポイントURL更新
2. 認証ヘッダー形式の調整
3. 再度接続テスト実行
4. 本番データ取得・分析開始

---

**重要**: 現在のシステムは完全に構築済みです。API仕様さえ判明すれば、即座に稼働開始できます。

---

## 関連ドキュメント

- [[API_ARCHITECTURE_UPDATE]]
- [[API_SPECIFICATION]]
- [[GOOGLE_SHEETS_SETUP]]
- [[README]]
- [[WEBHOOK_SETUP]]
- [[WEBHOOK_TEST_REPORT]]

